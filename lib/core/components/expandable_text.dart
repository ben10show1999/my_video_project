import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import 'package:my_video_project/core/logic/app_provider.dart';
// Task 13: LayoutBuilder implementation for smart text expansion
class ExpandableText extends StatefulWidget { final String text; final int maxLines; const ExpandableText({super.key, required this.text, this.maxLines = 3}); @override State<ExpandableText> createState() => _ExpandableTextState(); }
class _ExpandableTextState extends State<ExpandableText> { bool _expanded = false; @override Widget build(BuildContext context) { final p = Provider.of<AppProvider>(context); return LayoutBuilder(builder: (context, constraints) { final span = TextSpan(text: widget.text, style: const TextStyle(color: Colors.white70, fontSize: 14, height: 1.5)); final tp = TextPainter(text: span, maxLines: widget.maxLines, textDirection: TextDirection.ltr); tp.layout(maxWidth: constraints.maxWidth); final bool isOverflowing = tp.didExceedMaxLines; return Column(crossAxisAlignment: CrossAxisAlignment.start, children: [Text(widget.text, maxLines: _expanded ? null : widget.maxLines, overflow: _expanded ? TextOverflow.visible : TextOverflow.ellipsis, style: const TextStyle(color: Colors.white70, fontSize: 14, height: 1.5)), if (isOverflowing) ...[const SizedBox(height: 4), GestureDetector(onTap: () => setState(() => _expanded = !_expanded), child: Text(_expanded ? p.tr('show_less') : p.tr('show_more'), style: const TextStyle(color: Colors.amber, fontWeight: FontWeight.bold, fontSize: 12)))]]); }); } }
